const db_Connector = require("../helper/DB_Connector.js")
const productCollection = require("../helper/ProductCollection.js")

const db = new DB_Connector("http://127.0.0.1:8090");
const pC = new productCollection(db, 5)

class transaction_Handler{

    placeOrder(buyer, items){
        
        if(!Array.isArray(items)){
            throw new Error("Expected Array of items");
        }
        
        if (!pC.checkCache() && !items.every(item => pC.productCollection.find(prod => prod.id == item.id))){
            pC.loadProducts()
        }

        items = items.map((item) => {
            let dbItem = pC.productCollection.find(prod => prod.id = item.id);
            //TODO: Rabattstuff
            item.price = dbItem.price;
            item.total = (item.price * item.amount).toFixed(2);
        })

        
    }
}